cmake_minimum_required(VERSION 3.7)

set(PROJECT_NAME chuck)
project(${PROJECT_NAME})
# List all compile flags here
set(CMAKE_EXPORT_COMPILE_COMMANDS 1)
set(_CFLAGS "-O3 -march=native -std=c11 -D__LINUX_ALSA__ -D__UNIX_JACK__ -D__PLATFORM_LINUX__ -fno-strict-aliasing  -D__CK_SNDFILE_NATIVE__ -B chuck/src/ck -B chuck/src/src/ck/lo -B chuck/src/src/ck/rgx  -DHAVE_CONFIG_H -I. -D_USE_AUTOCONF -D_GNU_SOURCE -D_FORTIFY_SOURCE=2 -D_GNU_SOURCE=1 -D_REENTRANT -DUSE_ALSA -DUSE_DLTRICK_ALSA -DUSE_OSS -DUSE_NETWORK -DUSE_X11 -DUSE_XV -mtune=generic -fPIC -pipe -fstack-protector-strong -fno-plt -B --sysroot -I./src/core -I./src/core/lo -I./src/core/regex -I./scripts -I/usr/include/SDL -I/usr/lib/gcc/x86_64-pc-linux-gnu/8.2.1/include")
set(_CXXFLAGS "-O3 -march=native -std=c++14 -D__LINUX_ALSA__ -D__UNIX_JACK__ -D__PLATFORM_LINUX__ -fno-strict-aliasing  -D__CK_SNDFILE_NATIVE__ -DHAVE_CONFIG_H -I. -D_USE_AUTOCONF -D_GNU_SOURCE -D_FORTIFY_SOURCE=2 -D_GNU_SOURCE=1 -D_REENTRANT -DUSE_ALSA -DUSE_DLTRICK_ALSA -DUSE_OSS -DUSE_NETWORK -DUSE_X11 -march=x86-64 -mtune=generic -fPIC  -pipe -fstack-protector-strong -fno-plt -B --sysroot -I./src/core -I./src/core/lo -I./src/core/regex -I./scripts -I/usr/include/SDL -I/usr/lib/gcc/x86_64-pc-linux-gnu/8.2.1/include")
set(CMAKE_C_FLAGS "${_CFLAGS}")
set(CMAKE_CXX_FLAGS "${_CXXFLAGS}")
set(ENV{CC} "gcc")
set(ENV{CXX} "g++")
set(ENV{LD} "ld")
# TODO: uncomment if have unit tests
# enable_testing()
# find_program( CLANG_TIDY NAMES clang-tidy)
# NOTE: you can add search paths for example `PATHS /usr/local/opt/llvm/bin/`
message("\n--------------------------------\n")
message("PROJECT NAME:\t\t${PROJECT_NAME}")
message("CMAKE_SYSTEM_NAME:\t${CMAKE_SYSTEM_NAME}")
message("CMAKE_C_COMPILER:\t${CMAKE_C_COMPILER}")
message("CMAKE_CXX_COMPILER:\t${CMAKE_CXX_COMPILER}")
message("CMAKE_GENERATOR:\t${CMAKE_GENERATOR}")
message("CMAKE_BUILD_TYPE:\t${CMAKE_BUILD_TYPE}")
message("CMAKE_BINARY_DIR:\t${CMAKE_BINARY_DIR}")
message("CMAKE_MODULE_PATH:\t${CMAKE_MODULE_PATH}")
message("CMAKE_PREFIX_PATH:\t${CMAKE_PREFIX_PATH}")
message("clang-tidy:\t\t${CLANG_TIDY}")
message("\n--------------------------------\n")
set(${PROJECT_NAME}_sources "src/core/chuck.cpp" "src/core/chuck.yy.c" "src/core/chuck.tab.c" "src/core/chuck_absyn.cpp" "src/core/chuck_carrier.cpp" "src/core/chuck_compile.cpp" "src/core/chuck_dl.cpp" "src/core/chuck_emit.cpp" "src/core/chuck_errmsg.cpp" "src/core/chuck_frame.cpp" "src/core/chuck_instr.cpp" "src/core/chuck_io.cpp" "src/core/chuck_lang.cpp" "src/core/chuck_oo.cpp" "src/core/chuck_otf.cpp" "src/core/chuck_parse.cpp" "src/core/chuck_scan.cpp" "src/core/chuck_shell.cpp" "src/core/chuck_stats.cpp" "src/core/chuck_symbol.cpp" "src/core/chuck_table.cpp" "src/core/chuck_type.cpp" "src/core/chuck_ugen.cpp" "src/core/chuck_utils.cpp" "src/core/chuck_vm.cpp" "src/core/hidio_sdl.cpp" "src/core/midiio_rtmidi.cpp" "src/core/rtmidi.cpp" "src/core/uana_extract.cpp" "src/core/uana_xform.cpp" "src/core/ugen_filter.cpp" "src/core/ugen_osc.cpp" "src/core/ugen_stk.cpp" "src/core/ugen_xxx.cpp" "src/core/ulib_machine.cpp" "src/core/ulib_math.cpp" "src/core/ulib_opsc.cpp" "src/core/ulib_regex.cpp" "src/core/ulib_std.cpp" "src/core/util_buffers.cpp" "src/core/util_console.cpp" "src/core/util_hid.cpp" "src/core/util_math.c" "src/core/util_network.c" "src/core/util_opsc.cpp" "src/core/util_raw.c" "src/core/util_serial.cpp"  "src/core/util_sndfile.c" "src/core/util_string.cpp" "src/core/util_thread.cpp" "src/core/util_xforms.c" "src/core/lo/address.c" "src/core/lo/blob.c" "src/core/lo/bundle.c" "src/core/lo/message.c" "src/core/lo/method.c" "src/core/lo/pattern_match.c" "src/core/lo/send.c" "src/core/lo/server.c" "src/core/lo/server_thread.c" "src/core/lo/timetag.c" "src/host/chuck_audio.cpp" "src/host/chuck_console.cpp" "src/host/libchuck.cpp" "src/core/chuck.tab.c" "src/core/chuck.yy.c")
# find_package(BISON)
# find_package(FLEX)
# BISON_TARGET(ChuckParser src/core/chuck.y ${CMAKE_CURRENT_BINARY_DIR}/chuck.yy.c)
# FLEX_TARGET(ChuckLexer src/core/chuck.lex ${CMAKE_CURRENT_BINARY_DIR}/chuck.tab.h ${CMAKE_CURRENT_BINARY_DIR}/chuck.tab.c)
# ADD_FLEX_BISON_DEPENDENCY(ChuckLexer ChuckParser)
# add_executable(${PROJECT_NAME} ${${PROJECT_NAME}_sources})
add_library(${PROJECT_NAME} ${${PROJECT_NAME}_sources})
# NOTE: this will slow down compilation, but you'll have static code analysis :)
if(CLANG_TIDY)
    set_property(
        TARGET ${PROJECT_NAME}
        PROPERTY CXX_CLANG_TIDY "${CLANG_TIDY}")
endif()
set_property(TARGET ${PROJECT_NAME} PROPERTY CXX_STANDARD 17)
set_property(TARGET ${PROJECT_NAME} PROPERTY CXX_STANDARD_REQUIRED ON)
